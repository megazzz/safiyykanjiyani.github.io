/* Reslide 1.0 - Licensed under the MIT licenses - Copyright (c) 2012 by Diego Parisi - Website: http://www.diegoparisi.com/ */
(function(a){a.reslide=function(b,c){var d={images:[],fx:"fade",pagers:false,direction:"forward",loop:true,autoplay:false,delay:3e3,speed:1e3,onBefore:function(a,b,c){},onAfter:function(a){}};var e={elements:0,timeout:null,isChanging:false,isPlaying:false};var f=this;f.settings={};var b=a(b),b=b;var g=function(){f.settings=a.extend({},d,c);f.vars=e;var g=0;if(f.settings.images.length>0){var l=a('<ul class="reslide"></ul>');l.appendTo(b);f.vars.elements=f.settings.images.length;if(f.settings.direction=="backward")g=f.vars.elements-1;jQuery.each(f.settings.images,function(b,c){var d=a("<li></li>").addClass("loading");d.appendTo(l);if(b==0&&f.settings.direction=="forward")d.addClass("front");else if(b==f.vars.elements-1&&f.settings.direction=="backward")d.addClass("front");else d.addClass("back")});h(g,l,true)}else if(b.children(".reslide").length>0){f.vars.elements=b.children(".reslide").children("li").length;if(f.settings.direction=="backward")g=f.vars.elements-1;b.children(".reslide").children("li").each(function(b,c){var d=a(this);i(d);if(b==g&&f.settings.autoplay==true&&f.vars.elements>1)p();else if(f.settings.autoplay==false||f.vars.elements<2)o();if(b==0&&f.settings.direction=="forward")d.addClass("front");else if(b==f.vars.elements-1&&f.settings.direction=="backward")d.addClass("front");else d.addClass("back")})}j();k();a(f.settings.prev).click(function(){o();m()});a(f.settings.next).click(function(){o();n()});a(f.settings.toggle).click(function(){q()});b.children(".reslide-pagers").children("li").click(function(){f.goToSlide(a(this).attr("goToSlide"))})};var h=function(b,c,d){var e=b;var g=b+1;var h=b-1;if(g>f.vars.elements-1)g=0;if(h<0)h=f.vars.elements-1;var j=[];j.push(f.settings.images[e],f.settings.images[g],f.settings.images[h]);jQuery.each(j,function(b,j){var k;switch(b){case 0:k=e;break;case 1:k=g;break;case 2:k=h;break}var l=c.children("li").get(k);if(a(l).hasClass("loading")==true){if(j.target==null)j.target="_blank";if(j.href==null)var m="";else var m=' href="'+j.href+'"';var n=a('<a target="'+j.target+'"'+m+" ></a>");n.appendTo(l);if(j.fit==null)j.fit=true;if(j.src==null)var q="";else var q=' src="'+j.src+'"';var r=a('<img fit="'+j.fit+'"'+q+"/>");r.appendTo(n);r.load(function(){i(l);a(l).removeClass("loading");if(d==true){if(k==e&&f.settings.autoplay==true&&f.vars.elements>1)p();else if(f.settings.autoplay==false||f.vars.elements<2)o()}})}})};var i=function(b){a(b).children("a").children("img").each(function(){if(a(this).attr("fit")=="true"){var c=a(b).width();var d=a(b).height();var e=a(this).height()/a(this).width();var f=d/c;if(f>e)a(this).width(d/e).height(d);else a(this).width(c).height(c*e)}a(this).css({top:"50%",marginTop:-(a(this).height()/2)});a(this).css({left:"50%",marginLeft:-(a(this).width()/2)})})};var j=function(){if(f.settings.pagers&&f.vars.elements>1){b.append('<ul class="reslide-pagers"></ul>');b.children(".reslide").children("li").each(function(c,d){var e=c+1;var f=a('<li goToSlide="'+e+'">'+e+"</li>");f.appendTo(b.children(".reslide-pagers"))})}};var k=function(){if(b.children(".reslide-pagers").length>0){var a=b.children(".reslide").children("li.front").index()+1;var c=b.children(".reslide-pagers");c.children("li").removeClass("active");c.children("li:nth-child("+a+")").addClass("active")}};var l=function(a,b,c){f.vars.isChanging=true;f.settings.onBefore.call(this,a,b,c);switch(f.settings.fx){case"none":a.removeClass("front").addClass("back");b.removeClass("back").addClass("front");k();f.vars.isChanging=false;f.settings.onAfter.call(this,b);break;case"fade":a.css({zIndex:-20});b.css({zIndex:-10,opacity:0}).removeClass("back").addClass("front").animate({opacity:1},f.settings.speed,function(){a.removeClass("front").addClass("back");k();f.vars.isChanging=false;f.settings.onAfter.call(this,b)});break;case"fold":a.css({zIndex:-20});if(c=="forward"){b.css({zIndex:-10,left:a.width()}).removeClass("back").addClass("front");b.animate({left:0},f.settings.speed,function(){a.removeClass("front").addClass("back");k();f.vars.isChanging=false;f.settings.onAfter.call(this,b)})}else if(c=="backward"){b.css({zIndex:-10,left:-a.width()}).removeClass("back").addClass("front");b.animate({left:0},f.settings.speed,function(){a.removeClass("front").addClass("back");k();f.vars.isChanging=false;f.settings.onAfter.call(this,b)})}break;case"slide":a.css({zIndex:-20});if(c=="forward"){b.css({zIndex:-10,left:a.width()}).removeClass("back").addClass("front");a.animate({left:-a.width()},f.settings.speed);b.animate({left:0},f.settings.speed,function(){a.removeClass("front").addClass("back");k();f.vars.isChanging=false;f.settings.onAfter.call(this,b)})}else if(c=="backward"){b.css({zIndex:-10,left:-a.width()}).removeClass("back").addClass("front");a.animate({left:a.width()},f.settings.speed);b.animate({left:0},f.settings.speed,function(){a.removeClass("front").addClass("back");k();f.vars.isChanging=false;f.settings.onAfter.call(this,b)})}break;default:a.removeClass("front").addClass("back");b.removeClass("back").addClass("front");k();f.vars.isChanging=false;f.settings.onAfter.call(this,b)}};var m=function(){if(f.vars.isChanging||f.vars.elements==1)return;var a;var c=b.children(".reslide");var d=c.children("li.front");if(d.index()==0&&f.settings.loop==false){o();return}if(d.prev().length>0)a=d.prev();else a=c.children("li:last");h(a.index(),c,false);l(d,a,"backward")};var n=function(){if(f.vars.isChanging||f.vars.elements==1)return;var a;var c=b.children(".reslide");var d=c.children("li.front");if(d.index()+1==f.vars.elements&&f.settings.loop==false){o();return}if(d.next().length>0)a=d.next();else a=c.children("li:first");h(a.index(),c,false);l(d,a,"forward")};var o=function(){f.vars.isPlaying=false;if(f.settings.toggle)a(f.settings.toggle).removeClass("reslide-play").addClass("reslide-pause");clearTimeout(f.vars.timeout)};var p=function(){f.vars.isPlaying=true;if(f.settings.toggle)a(f.settings.toggle).removeClass("reslide-pause").addClass("reslide-play");var c=b.children(".reslide");var d=c.children("li.front");f.vars.timeout=setTimeout(function(){if(!d.hasClass("loading front")){if(f.settings.direction=="forward")n();else if(f.settings.direction=="backward")m()}if(f.vars.isPlaying==true)p()},f.settings.delay+f.settings.speed)};var q=function(){if(f.vars.isChanging||f.vars.elements==1)return;if(f.vars.isPlaying==true)o();else p()};f.goToSlide=function(a){if(f.vars.isChanging||f.vars.elements==1)return;if(a<1||a>f.vars.elements)return;o();var c=b.children(".reslide");var d=c.children("li.front");var e=c.children("li:nth-child("+a+")");h(e.index(),c,false);if(e.index()!=-1&&e.index()!=d.index()){if(f.settings.loop==false){if(d.index()>e.index())l(d,e,"backward");else l(d,e,"forward")}else{l(d,e,f.settings.direction)}}};a(window).resize(function(){a(".reslide").each(function(){i(a(this).children("li"))})});g()};a.fn.reslide=function(b){if(b==undefined&&a(this).data("reslide")!=undefined){return a(this).data("reslide")}else{return this.each(function(){if(undefined==a(this).data("reslide")){var c=new a.reslide(this,b);a(this).data("reslide",c)}})}}})(jQuery)